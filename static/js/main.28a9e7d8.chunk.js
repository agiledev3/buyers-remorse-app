(this["webpackJsonpbuyers-remorse-app"]=this["webpackJsonpbuyers-remorse-app"]||[]).push([[0],{39:function(e){e.exports=JSON.parse('["How often do you think you are going to use this product?","Where will you keep this product when you are not using it? Do you have enough space?","How can buying this product be harmful to the environment?"]')},40:function(e){e.exports=JSON.parse('{"products":[{"id":1,"name":"First product","likeCount":3,"linkToBuy":"www.lorem.ipsum","reasonToBuy":"dolor","reminderPeriod":7,"coolingPeriod":30,"createdAt":"2021-01-01T18:00:00.000Z"},{"id":2,"name":"Second product","likeCount":1,"linkToBuy":"www.lorem.ipsum","reasonToBuy":"dolor","reminderPeriod":7,"coolingPeriod":30,"createdAt":"2021-01-10T18:00:00.000Z"},{"id":3,"name":"Third product","likeCount":5,"linkToBuy":"www.lorem.ipsum","reasonToBuy":"dolor","reminderPeriod":7,"coolingPeriod":30,"createdAt":"2021-02-14T18:00:00.000Z"}]}')},53:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),c=n(15),a=n.n(c),s=n(8),i=n(17),u=n(63),d=n(56),l=n(38),j=n(55),h=n(57),b={HOME:"Home",EDIT_PRODUCT:"EDIT_PRODUCT"},O=n(60),m=n(1),f=function(e){var t=e.answersCount>=3;return Object(m.jsxs)(O.a,{show:e.show,onHide:e.handleDeclineClick,children:[Object(m.jsx)(O.a.Body,{children:t?"Are you sure you would like to buy this product?":"Please answer at least 3 awareness questions to unlock the buy button."}),t?Object(m.jsxs)(O.a.Footer,{children:[Object(m.jsx)(j.a,{variant:"secondary",onClick:e.handleDeclineClick,children:"No"}),Object(m.jsx)(j.a,{variant:"danger",onClick:e.handleConfirmClick,children:"Yes"})]}):Object(m.jsx)(O.a.Footer,{children:Object(m.jsx)(j.a,{variant:"secondary",onClick:e.handleDeclineClick,children:"Close"})})]})};var p=function(e){var t=Object(r.useState)(!1),n=Object(s.a)(t,2),o=n[0],c=n[1],a=e.product,i=a.id,O=a.name,p=a.daysLeft,x=a.likeCount,g=a.questions,w=g?Object.values(g).length:0,y=0===p;return Object(m.jsxs)(r.Fragment,{children:[Object(m.jsxs)(u.a,{className:"p-3",id:i,children:[Object(m.jsx)(u.a.Title,{children:O}),Object(m.jsxs)(d.a,{children:[Object(m.jsx)(l.a,{xs:{span:4},children:Object(m.jsxs)(j.a,{variant:"btn btn-outline-success",className:"px-4",onClick:function(){return e.removeProduct(e.product,!0)},children:[Object(m.jsx)("i",{className:"far fa-thumbs-up"})," Forget"]})}),Object(m.jsxs)(l.a,{xs:{span:8},className:"text-right",children:[Object(m.jsxs)(j.a,{variant:"outline-danger",title:"Buy product",className:"px-3 mb-1 mx-1",onClick:function(){return c(!0)},disabled:!y,children:[Object(m.jsx)("i",{className:"fas fa-shopping-cart"})," ",y?"Buy":p+" days to unlock"]}),Object(m.jsx)(j.a,{variant:"outline-secondary",title:"Edit product",onClick:function(){e.changePage(b.EDIT_PRODUCT),e.setCurrentProduct(e.product)},className:"mb-1",children:Object(m.jsx)("i",{className:"fas fa-pen"})}),Object(m.jsxs)(j.a,{variant:"success",onClick:function(){return e.openNewQuestionModal(e.product)},className:"px-2 mb-1 ml-1",children:[Object(m.jsx)("i",{className:"fas fa-question-circle"}),Object(m.jsx)("sup",{children:Object(m.jsx)(h.a,{variant:"light",children:x})})]})]})]})]},i),Object(m.jsx)(f,{show:o,handleConfirmClick:function(){return e.removeProduct(e.product,!1)},handleDeclineClick:function(){return c(!1)},answersCount:w})]})};var x=function(e){return Object(m.jsxs)("div",{children:[e.allProducts.map((function(t){return Object(m.jsx)(p,{product:t,changePage:e.changePage,openNewQuestionModal:e.openNewQuestionModal,removeProduct:e.removeProduct,setCurrentProduct:e.setCurrentProduct},t.id)})),Object(m.jsx)(j.a,{variant:"primary",className:"float-right my-3",title:"Add new product",onClick:function(){e.changePage(b.EDIT_PRODUCT)},children:Object(m.jsx)("i",{className:"fas fa-plus"})})]})},g=n(61),w=function(e){var t=function(){e.onSaveClick({productId:e.productId,question:e.question,answer:e.answer})};return Object(m.jsxs)(O.a,{show:e.show,onHide:e.onHide,onKeyDown:function(n){e.question&&13===n.keyCode&&(n.preventDefault(),0!==e.answer.length&&t())},children:[Object(m.jsx)(O.a.Header,{children:Object(m.jsx)(O.a.Title,{children:"Increase product buying score"})}),Object(m.jsxs)(O.a.Body,{children:[!!e.question&&Object(m.jsx)(g.a,{children:Object(m.jsxs)(g.a.Group,{controlId:"formQuestion",children:[Object(m.jsx)(g.a.Label,{children:e.question}),Object(m.jsx)(g.a.Control,{type:"text",placeholder:"Enter your answer...",value:e.answer,onChange:function(t){return e.onAnswerChange(t.target.value)},autoFocus:!0}),Object(m.jsx)(g.a.Text,{muted:!0,children:"To increase the score of this product you must answer the question above."})]})}),!e.question&&Object(m.jsx)("p",{children:Object(m.jsx)("strong",{children:"Do you want to increase the buying score of this product?"})})]}),Object(m.jsxs)(O.a.Footer,{children:[Object(m.jsx)(j.a,{variant:"outline-secondary",onClick:e.onHide,children:"Cancel"}),Object(m.jsx)(j.a,{variant:"primary",disabled:!!e.question&&0===e.answer.length,onClick:t,children:"Confirm"})]})]})},y=function(e){var t=Object(r.useState)(!1),n=Object(s.a)(t,2),o=n[0],c=n[1],a=Object(r.useState)(""),i=Object(s.a)(a,2),u=i[0],d=i[1],l=Object(r.useState)(""),j=Object(s.a)(l,2),h=j[0],b=j[1],O=Object(r.useState)(null),m=Object(s.a)(O,2),f=m[0],p=m[1];return{closeNewQuestionModal:function(){b(""),c(!1)},openNewQuestionModal:function(t){d(function(e,t){return t.questions?e.find((function(e){return!t.questions[e]})):e[0]}(e,t)),p(t.id),c(!0)},handleAnswerChange:function(e){b(e)},question:u,show:o,answer:h,productId:f}},v=n(62),P=function(e){return Object(m.jsxs)(r.Fragment,{children:[Object(m.jsx)(v.a,{show:e.showForgetAlert,variant:"success",className:"my-1",children:Object(m.jsxs)("p",{children:[Object(m.jsx)("i",{className:"far fa-smile"})," The product has been removed from the list. Good job!"]})}),Object(m.jsx)(v.a,{show:e.showBoughtAlert,variant:"danger",className:"my-1",children:Object(m.jsxs)("p",{children:[Object(m.jsx)("i",{className:"far fa-frown"})," The product has been marked as bought and removed from the list."]})})]})},C=n(39),k=n(18),S=n(19),T=n(32),N=n.n(T),B=function(e,t,n){var r=new Notification(e,{body:t});return r.onclick=n,r};var D=function(){function e(t,n,r){Object(k.a)(this,e),this._products=t,this._onClick=r,this._onShow=n}return Object(S.a)(e,[{key:"showExpiredReminders",value:function(){var e=this;this._products.forEach((function(t){var n=t.createdAt,r=t.lastNotification,o=t.reminderPeriod,c=t.name,a=t.id,s=(r?N()(r):N()(n)).add(o,"days");N()().isAfter(s)&&(!function(e,t,n){if("Notification"in window){if("granted"===Notification.permission)return B(e,t,n);"denied"!==Notification.permission&&Notification.requestPermission().then((function(r){if("granted"===r)return B(e,t,n)}))}else console.warn("This browser does not support desktop notification")}("Hey, a reminder about ".concat(c),"It passed more than ".concat(o," days since you checked this product."),(function(){return e._onClick(a)})),e._onShow(a))}))}}]),e}(),A=function(e){var t=y(C),n=t.openNewQuestionModal,o=t.closeNewQuestionModal,c=t.handleAnswerChange,a=t.show,s=t.question,u=t.answer,d=t.productId;return Object(r.useEffect)((function(){e.setStaticHeader({title:"My wishlist",onBackButtonClick:null})}),[]),Object(r.useEffect)((function(){new D(e.allProducts,(function(t){return e.updateProduct(t,{lastNotification:new Date})}),(function(t){e.changePage(b.EDIT_PRODUCT),e.setCurrentProduct(t)})).showExpiredReminders()})),Object(m.jsxs)(r.Fragment,{children:[Object(m.jsx)(x,{allProducts:e.allProducts,changePage:e.changePage,removeProduct:e.removeProduct,setCurrentProduct:e.setCurrentProduct,openNewQuestionModal:n}),Object(m.jsx)(w,{productId:d,show:a,question:s,answer:u,onHide:o,onSaveClick:function(t){var n=t.productId,r=t.question,c=t.answer;r&&c&&e.updateProduct(n,{questions:Object(i.a)({},r,c)}),e.increaseLikeCount(n),o()},onAnswerChange:c}),Object(m.jsx)(P,{showForgetAlert:e.showForgetAlert,showBoughtAlert:e.showBoughtAlert})]})},I=n(10),F=function(e){var t=e||{name:"",linkToBuy:"",reasonToBuy:"",reminderPeriod:7,coolingPeriod:30},n=Object(r.useState)(t),o=Object(s.a)(n,2),c=o[0],a=o[1];return{handleChange:function(e){var t=e.target,n=t.name,r=t.value;a(Object(I.a)(Object(I.a)({},c),{},Object(i.a)({},n,r)))},handleReset:function(){a(Object(I.a)({},t))},product:c}},H=n(58),E=function(e){var t=F(e.product),n=t.handleChange,o=t.handleReset,c=t.product,a=!!c.id,s=!!c.questions,i=s?Object.keys(c.questions):[],u=s?Object.values(c.questions):[],d=function(){o(),e.changePage(b.HOME),e.setCurrentProduct(null)};return Object(r.useEffect)((function(){e.setStaticHeader({title:"Product Details",onBackButtonClick:d})}),[]),Object(m.jsxs)(g.a,{className:"product-form",onSubmit:function(t){t.preventDefault(),a?e.updateProduct(c.id,c):e.createProduct(c),e.changePage(b.HOME),e.setCurrentProduct(null)},children:[Object(m.jsxs)(g.a.Group,{children:[Object(m.jsx)(g.a.Label,{htmlFor:"name",children:"Product name:"}),Object(m.jsx)(g.a.Control,{onChange:n,value:c.name,placeholder:"Product name ...",name:"name",id:"name","data-testid":"name",required:!0})]}),Object(m.jsxs)(g.a.Group,{children:[Object(m.jsx)(g.a.Label,{htmlFor:"linkToBuy",children:"Link to buy:"}),Object(m.jsx)(g.a.Control,{onChange:n,value:c.linkToBuy,placeholder:"Link to a website ...",name:"linkToBuy",id:"linkToBuy",pattern:"(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_\\+.~#?&//=]*)",title:"Should be a valid web address, e.g. www.example.com"})]}),Object(m.jsxs)(g.a.Group,{children:[Object(m.jsx)(g.a.Label,{htmlFor:"reasonToBuy",children:"Why would you like to buy this product?"}),Object(m.jsx)(g.a.Control,{onChange:n,value:c.reasonToBuy,placeholder:"Reason to buy ...",name:"reasonToBuy",id:"reasonToBuy",as:"textarea",rows:"3",required:!0,disabled:a})]}),s&&Object(m.jsx)("div",{className:"my-2",children:i.map((function(e,t){return Object(m.jsxs)("div",{className:"my-1",children:[Object(m.jsx)("p",{children:e}),Object(m.jsx)("p",{className:"p-2",style:{border:"1px solid #ced4da",borderRadius:"0.25em",background:"#e9ecef",color:"#495057"},children:u[t]})]},t)}))}),Object(m.jsxs)(g.a.Row,{children:[Object(m.jsxs)(g.a.Group,{as:l.a,xs:"auto",children:[Object(m.jsx)(g.a.Label,{htmlFor:"reminderPeriod",children:"How long should I wait before I remind you about this product?"}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(H.a.Prepend,{children:Object(m.jsx)(H.a.Text,{children:"Days"})}),Object(m.jsx)(g.a.Control,{onChange:n,value:c.reminderPeriod,placeholder:"Days ...",name:"reminderPeriod",id:"reminderPeriod",type:"number",min:"1",max:"30",style:{maxWidth:"5rem"}})]})]}),Object(m.jsx)(l.a,{lg:"2"}),Object(m.jsxs)(g.a.Group,{as:l.a,xs:"auto",children:[Object(m.jsx)(g.a.Label,{htmlFor:"coolingPeriod",children:"How long should I lock the buy button?"}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(H.a.Prepend,{children:Object(m.jsx)(H.a.Text,{children:"Days"})}),Object(m.jsx)(g.a.Control,{onChange:n,value:c.coolingPeriod,placeholder:"Days ...",name:"coolingPeriod",id:"coolingPeriod",type:"number",min:"1",max:"90",style:{maxWidth:"5rem"}})]})]})]}),Object(m.jsxs)(g.a.Row,{children:[Object(m.jsx)(l.a,{children:Object(m.jsx)(j.a,{variant:"outline-danger",aligned:"left aligned",size:"lg",onClick:d,children:Object(m.jsx)("i",{className:"fas fa-times-circle"})})}),Object(m.jsx)(l.a,{xs:"auto",children:Object(m.jsx)(j.a,{variant:"outline-success",aligned:"right aligned",type:"submit",size:"lg",title:"Save product",children:Object(m.jsx)("i",{className:"fas fa-check"})})})]})]})},q=function(e){var t=Object(r.useState)(b.HOME),n=Object(s.a)(t,2),o=n[0],c=n[1];return Object(m.jsxs)(r.Fragment,{children:[o===b.HOME&&Object(m.jsx)(A,{allProducts:e.allProducts,changePage:c,setStaticHeader:e.setStaticHeader,updateProduct:e.updateProduct,removeProduct:e.removeProduct,setCurrentProduct:e.setCurrentProduct,increaseLikeCount:e.increaseLikeCount,showForgetAlert:e.showForgetAlert,showBoughtAlert:e.showBoughtAlert}),o===b.EDIT_PRODUCT&&Object(m.jsx)(E,{product:e.currentProduct,setCurrentProduct:e.setCurrentProduct,changePage:c,setStaticHeader:e.setStaticHeader,createProduct:e.createProduct,updateProduct:e.updateProduct})]})},L=n(25),_=(n(40),{initialize:function(e,t){return localStorage.setItem(e,t),this},read:function(e){var t=localStorage.getItem(e);return t?JSON.parse(t):[]},write:function(e,t,n){var r=this.read(e);n?r=r.filter((function(e){return e.id!==n})):t.id=this.calculateNextId(r),t&&r.push(t),localStorage.setItem(e,JSON.stringify(r))},calculateNextId:function(e){return e&&0!==e.length?Math.max.apply(Math,Object(L.a)(e.map((function(e){return e.id}))))+1:1}}),M=function(){function e(t,n){var r=this;Object(k.a)(this,e),this._calculateDaysLeft=function(e,t){var n=r.dateService.getCurrent().getTime(),o=(Date.parse(e)+t*r.dateService.msInDay()-n)/r.dateService.msInDay();return o>1?Math.ceil(o):0},this.dataSource=t,this.dateService=n}return Object(S.a)(e,[{key:"getAll",value:function(){var e=this,t=this._readProductsFromSource();return t.forEach((function(t){t.daysLeft=e._calculateDaysLeft(t.createdAt,t.coolingPeriod)})),t}},{key:"getOne",value:function(e){return this._readProductsFromSource().find((function(t){return t.id===e}))}},{key:"update",value:function(e,t){var n=this.getOne(e),r=Object(I.a)(Object(I.a)(Object(I.a)({},n),t),{},{questions:Object(I.a)(Object(I.a)({},n.questions),t.questions)});this._writeProductToSource(e,r)}},{key:"increaseLikeCount",value:function(e){var t=this.getOne(e),n=Object(I.a)(Object(I.a)({},t),{},{likeCount:void 0!==t.likeCount?t.likeCount+1:0});this._writeProductToSource(e,n)}},{key:"create",value:function(e){e.likeCount=0,e.createdAt=(new Date).toISOString(),e.daysLeft=e.coolingPeriod,this._writeProductToSource(null,e)}},{key:"remove",value:function(e){this._writeProductToSource(e,null)}},{key:"_readProductsFromSource",value:function(){return this.dataSource.read("products")}},{key:"_writeProductToSource",value:function(e,t){return this.dataSource.write("products",t,e)}}]),e}(),R=function(){function e(){Object(k.a)(this,e)}return Object(S.a)(e,[{key:"getCurrent",value:function(){return new Date}},{key:"msInDay",value:function(){return 864e5}}]),e}(),z=n(41),Q="appInstallLastPromptedAt";var G=function(){var e=Object(r.useState)(function(){if(navigator.standalone)return!1;var e=localStorage.getItem(Q);if(!e)return!0;var t=(new Date-Date.parse(e))/864e5;return isNaN(t)||t>1}()),t=Object(s.a)(e,2),n=t[0],o=t[1];return[z.isMobile&&n,function(){o(!1),localStorage.setItem(Q,(new Date).toISOString())}]},J=n.p+"static/media/pwa.87f7645c.ico",U=function(){var e=G(),t=Object(s.a)(e,2),n=t[0],r=t[1];return n?Object(m.jsxs)(O.a,{show:!0,children:[Object(m.jsx)(O.a.Header,{children:Object(m.jsx)("img",{className:"mx-auto",style:{borderTopRightRadius:"50%",borderTopLeftRadius:"50%"},width:"40rem",src:J,alt:"Icon"})}),Object(m.jsxs)(O.a.Body,{children:[Object(m.jsx)(u.a.Text,{className:"text-center",children:'Open browser menu and tap "Add to Home Screen" to install the app'}),Object(m.jsx)("div",{className:"d-flex justify-content-center",children:Object(m.jsx)(j.a,{onClick:r,children:"Close"})})]})]}):null},Z=function(){var e=Object(r.useState)({title:"Loading...",onBackButtonClick:null}),t=Object(s.a)(e,2);return{staticHeader:t[0],setStaticHeader:t[1]}};function W(e){var t=e.title,n=e.onBackButtonClick;return Object(m.jsx)(u.a,{className:"my-2",children:Object(m.jsxs)(u.a.Title,{className:"text-center",children:[Object(m.jsxs)(d.a,{className:"p-1",children:[Object(m.jsx)(l.a,{xs:{span:2},style:{fontSize:"2em",marginBottom:"-1em"},onClick:n?function(){return n()}:function(){},children:n&&Object(m.jsx)(j.a,{variant:"outline-dark",size:"lg",children:Object(m.jsx)("i",{className:"fas fa-chevron-left align-center"})})}),Object(m.jsx)(l.a,{xs:{span:8},children:"Felicity"}),Object(m.jsx)(l.a,{xs:{span:2},style:{fontSize:"2em"}})]}),Object(m.jsxs)(d.a,{children:[Object(m.jsx)(l.a,{sm:{span:2}}),Object(m.jsx)(l.a,{sm:{span:8},children:t}),Object(m.jsx)(l.a,{sm:{span:2}})]})]})})}var K=function(e){var t=e.error,n=e.setError;return Object(m.jsx)(r.Fragment,{children:t&&Object(m.jsxs)(v.a,{show:!!t,variant:"danger",className:"my-1",onClose:function(){return n(null)},dismissible:!0,children:[Object(m.jsx)(v.a.Heading,{children:t.heading}),Object(m.jsx)("p",{children:t.body})]})})},Y=function(e){var t=Object(r.useState)(null),n=Object(s.a)(t,2),o=n[0],c=n[1],a=function(){try{return e.getAll()}catch(t){o||setTimeout((function(){c({heading:"Error loading products",body:t.message})}),500)}return[]},i=Object(r.useState)(a()),u=Object(s.a)(i,2),d=u[0],l=u[1],j=Object(r.useState)(null),h=Object(s.a)(j,2),b=h[0],O=h[1],f=Object(r.useState)(!1),p=Object(s.a)(f,2),x=p[0],g=p[1],w=Object(r.useState)(!1),y=Object(s.a)(w,2),v=y[0],P=y[1];return{allProducts:d,createProduct:function(t){try{e.create.bind(e)(t)}catch(n){o||setTimeout((function(){c({heading:"Error adding new products",body:n.message})}),500)}l(a())},removeProduct:function(t,n){try{e.remove.bind(e)(t.id)}catch(r){o||setTimeout((function(){c({heading:"Error removing product",body:r.message})}),500)}l(a()),n?g(!0):P(!0),setTimeout((function(){g(!1),P(!1)}),2e3)},updateProduct:function(t,n){try{e.update.bind(e)(t,n)}catch(r){o||setTimeout((function(){c({heading:"Error updating product",body:r.message})}),500)}l(a())},increaseLikeCount:function(t){e.increaseLikeCount.bind(e)(t),l(a())},setCurrentProduct:O,currentProduct:b,showForgetAlert:x,showBoughtAlert:v,productsErrorAlert:Object(m.jsx)(K,{error:o,setError:c})}},V=n(59),X=(n(52),new M(_,new R));var $=function(){var e=Z(),t=e.staticHeader,n=e.setStaticHeader,r=Y(X),o=r.allProducts,c=r.createProduct,a=r.removeProduct,s=r.updateProduct,i=r.increaseLikeCount,u=r.setCurrentProduct,d=r.currentProduct,l=r.showForgetAlert,j=r.showBoughtAlert,h=r.productsErrorAlert;return Object(m.jsxs)(V.a,{children:[Object(m.jsx)(U,{}),Object(m.jsx)(W,{title:t.title,onBackButtonClick:t.onBackButtonClick}),Object(m.jsx)(q,{allProducts:o,createProduct:c,removeProduct:a,updateProduct:s,increaseLikeCount:i,setCurrentProduct:u,currentProduct:d,setStaticHeader:n,showForgetAlert:l,showBoughtAlert:j}),h]})},ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,64)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),r(e),o(e),c(e),a(e)}))};a.a.render(Object(m.jsx)(o.a.StrictMode,{children:Object(m.jsx)($,{})}),document.getElementById("root")),ee()}},[[53,1,2]]]);
//# sourceMappingURL=main.28a9e7d8.chunk.js.map